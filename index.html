<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Critera - Smart Health</title>
	<link href="./src/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
	<link href="./src/assets/fontawesome/css/all.css" rel="stylesheet">
	<link href="./src/assets/custom/css/app.css" rel="stylesheet" />
	<script src="./src/assets/bootstrap/js/bootstrap.native.min.js"></script>

</head>

<body>
	<header>
		<nav class="navbar critera container-fluid fixed-top">
			<a class="navbar-brand" href="#">
				<img src="./src/assets/images/Logo.png" />
			</a>
		</nav>
	</header>
	<main id="app" :class="{'with-progress': show_progress}">
		<div v-if="visible" class="h-100">
			<nav class="navbar progress-section bg-light navbar-dark fixed-top px-0" v-if="show_progress">
				<div class="container-fluid critera d-flex flex-column">
					<div class="w-100">
						<template v-for="(step,i) in progress_sections">
							<template v-if="step.title && step.progress_color">
								<span class="step" :class="{'not_current': step.index != step_section}" :style="{color : step.progress_color}">{{ step.title }}</span>
							</template>
						</template>
					</div>
					<div class="w-100 d-flex flex-row progress-row">
						<template v-for="(step,i) in progress_sections">
							<template v-if="step.title && step.progress_color">
								<div class="progress" :style="{width : `${100 / progress_sections.filter(x=>x.title && x.progress_color).length}%`}">
									<div class="progress-bar" :class="{'current' : step_section == step.index}" role="progressbar" :style="{width : getProgressSectionPercentage(step),backgroundColor : step.progress_color}" aria-valuemin="0" aria-valuemax="100">
										<div class="value">
											{{ step_question+1 }}/{{ step.total_questions }}
										</div>
									</div>
								</div>
							</template>
						</template>
					</div>
				</div>
			</nav>
			<div class="container-fluid critera h-100 d-flex flex-column">
				<div class="question-section mt-5">
					<h1 class="text" v-if="current_question.text">
						<dynamic-component :template-html="current_question.text" :key="`${global_index}_text`" :context="form" />
					</h1>
					<div class="subtext">
						<div v-if="current_question.subtext">
							<dynamic-component :template-html="current_question.subtext" :key="`${global_index}_subtext`" :context="form" />
						</div>
						<div class="separator"></div>
					</div>
				</div>
				<div class="answer-section my-3">
					<div class="row">
						<div class="col-md-6 col-sm-12" v-if="['text'].includes(current_input.type)">
							<div class="input-group" :class="{'is-success' : testRegex(current_input.validation_rule,form[current_input.field])}">
								<input :type="current_input.type" v-mask="current_input.mask" class="form-control" :placeholder="current_input.placeholder" v-model="form[current_input.field]" />
							</div>
						</div>
						<template v-if="['radio'].includes(current_input.type)">
							<div class="form-check col-sm-12 col-md-3" v-for="(option,o) in current_input.options">
								<label class="critera radio h-100" :class="{'selected' : option.value == form[current_input.field]}">
									<div class="col-sm-12 col-md-9">
										{{ option.label }}
									</div>
									<div class="col-sm-12 col-md-3 col-sm-12 col-md-4 text-right">
										<input class="form-check-input" type="radio" :name="current_input.field" :id="`${current_input.field}_${o}`" :value="option.value" v-model="form[current_input.field]">
										<i class="far fa-dot-circle ml-auto" v-if='option.value == form[current_input.field]'></i>
										<i class="far fa-circle ml-auto" v-else></i>
									</div>
								</label>
							</div>
						</template>
						<template v-if="['checkbox'].includes(current_input.type)">
							<div class="form-check col-sm-12 col-md-3" v-for="(option,o) in current_input.options">
								<label class="critera radio h-100" :class="{'selected' : (form[current_input.field]??[]).includes(option.value)}">
									<div class="col-sm-12 col-md-9">
										{{ option.label }}
									</div>
									<div class="col-sm-12 col-md-3 col-sm-12 col-md-4 text-right">
										<input class="form-check-input" type="checkbox" :name="current_input.field" :id="`${current_input.field}_${o}`" :value="option.value" v-model="form[current_input.field]">
										<i class="far fa-dot-circle ml-auto" v-if='(form[current_input.field]??[]).includes(option.value)'></i>
										<i class="far fa-circle ml-auto" v-else></i>
									</div>
								</label>
							</div>
						</template>
						<template v-if="['ball-input'].includes(current_input.type)">
							<div class="form-check" v-for="(option,o) in input.options">
								<label class="critera ball-input" :class="{'selected' : option == form[current_input.field]}">
									{{ option }}
									<input class="form-check-input" type="radio" :name="current_input.field" :id="`${current_input.field}_${o}`" :value="option" v-model="form[current_input.field]">
								</label>
							</div>
						</template>
					</div>
				</div>
				<div class="buttons-section mt-auto">
					<div class="row">
						<div class="col-12 d-flex justify-content-end">
							<button class="btn criteria outline mr-3" @click="previousQuestion" v-if="can_go_back">Voltar</button>
							<button class="btn criteria" @click="nextQuestion" :disabled="!can_next">Pr√≥xima</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<script src=" ./src/assets/vue/js/vue2.min.js"></script>
	<script src="./src/assets/vue/js/v-mask.min.js"></script>
	<script src="./src/components/dynamic_component.js"></script>
	<script src="./src/services/app.js"></script>

</html>

</html>